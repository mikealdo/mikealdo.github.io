<!DOCTYPE html>
<html>
  <head>
    <title>Read only master branch</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    <link rel="apple-touch-icon" sizes="57x57" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-57x57.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="60x60" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-60x60.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="72x72" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-72x72.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="76x76" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-76x76.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="114x114" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-114x114.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="120x120" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-120x120.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="144x144" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-144x144.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="152x152" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-152x152.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="apple-touch-icon" sizes="180x180" href="//mikealdo.github.io/themes/uno-zen/assets/img/apple-touch-icon-180x180.png?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="icon" type="image/png" href="//mikealdo.github.io/themes/uno-zen/assets/img/favicon-32x32.png?v=wAAv6Wqe6l?v=1.0.0" sizes="32x32">
    <link rel="icon" type="image/png" href="//mikealdo.github.io/themes/uno-zen/assets/img/favicon-194x194.png?v=wAAv6Wqe6l?v=1.0.0" sizes="194x194">
    <link rel="icon" type="image/png" href="//mikealdo.github.io/themes/uno-zen/assets/img/favicon-96x96.png?v=wAAv6Wqe6l?v=1.0.0" sizes="96x96">
    <link rel="icon" type="image/png" href="//mikealdo.github.io/themes/uno-zen/assets/img/android-chrome-192x192.png?v=wAAv6Wqe6l?v=1.0.0" sizes="192x192">
    <link rel="icon" type="image/png" href="//mikealdo.github.io/themes/uno-zen/assets/img/favicon-16x16.png?v=wAAv6Wqe6l?v=1.0.0" sizes="16x16">
    <link rel="manifest" href="//mikealdo.github.io/themes/uno-zen/assets/img/manifest.json?v=wAAv6Wqe6l?v=1.0.0">
    <link rel="shortcut icon" href="//mikealdo.github.io/themes/uno-zen/assets/img/favicon.ico?v=wAAv6Wqe6l?v=1.0.0">
    <meta name="msapplication-TileColor" content="#e74c3c">
    <meta name="msapplication-TileImage" content="//mikealdo.github.io/themes/uno-zen/assets/img/mstile-144x144.png?v=wAAv6Wqe6l?v=1.0.0">
    <meta name="msapplication-config" content="//mikealdo.github.io/themes/uno-zen/assets/img/browserconfig.xml?v=wAAv6Wqe6l?v=1.0.0">
    <meta name="theme-color" content="#e74c3c">
    <link rel="stylesheet" type="text/css" href="//mikealdo.github.io/themes/uno-zen/assets/css/uno-zen.css?v=1.0.0" />
    <link rel="canonical" href="https://mikealdo.github.io/2015/11/02/Read-only-master-branch.html" />
    
    <meta property="og:site_name" content="Michal Davídek - Programming blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Read only master branch" />
    <meta property="og:description" content="Continuous delivery Continuous delivery is about delivering high quality software to customer immediately after next feature is added to the codebase. This adding is based on version control system and now I would like to discuss one step in this..." />
    <meta property="og:url" content="https://mikealdo.github.io/2015/11/02/Read-only-master-branch.html" />
    <meta property="og:image" content="https://mikealdo.github.io/images//covers/read-only-master-branch.png" />
    <meta property="article:published_time" content="2015-11-01T23:00:00.000Z" />
    <meta property="article:modified_time" content="2016-02-11T19:10:38.035Z" />
    <meta property="article:tag" content="continuous delivery" />
    <meta property="article:tag" content="git" />
    <meta property="article:tag" content="jenkins" />
    <meta property="article:tag" content="stash" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Read only master branch" />
    <meta name="twitter:description" content="Continuous delivery Continuous delivery is about delivering high quality software to customer immediately after next feature is added to the codebase. This adding is based on version control system and now I would like to discuss one step in this..." />
    <meta name="twitter:url" content="https://mikealdo.github.io/2015/11/02/Read-only-master-branch.html" />
    <meta name="twitter:image:src" content="https://mikealdo.github.io/images//covers/read-only-master-branch.png" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Michal Davídek - Programming blog",
    "author": {
        "@type": "Person",
        "name": "Michal Davídek",
        "image": "https://avatars.githubusercontent.com/u/14245058?v=3",
        "url": "undefined/author/undefined",
        "sameAs": null
    },
    "headline": "Read only master branch",
    "url": "https://mikealdo.github.io/2015/11/02/Read-only-master-branch.html",
    "datePublished": "2015-11-01T23:00:00.000Z",
    "dateModified": "2016-02-11T19:10:38.035Z",
    "image": "https://mikealdo.github.io/images//covers/read-only-master-branch.png",
    "keywords": "continuous delivery,  git,  jenkins,  stash",
    "description": "Continuous delivery Continuous delivery is about delivering high quality software to customer immediately after next feature is added to the codebase. This adding is based on version control system and now I would like to discuss one step in this..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Michal Davídek - Programming blog" href="https://mikealdo.github.io/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
  </head>
  <body class="post-template tag-continuous-delivery tag-git tag-jenkins tag-stash">
    <header id="menu-button" class="expanded">
      <a><i class="icon icon-list"></i></a>
    </header>
    <aside class="cover" style="background: url(/images/background-cover.jpg) center/cover no-repeat fixed">
      <div class="cover container">
        <div class="profile">
          <a id="avatar-link" title="link to homepage for Michal Davídek - Programming blog" href="https://mikealdo.github.io/#open">
            <img src="/images/michal-davidek.png" alt="Michal Davídek - Programming blog avatar" class="profile avatar rounded hvr-buzz-out" />
            <h1 id="profile-title">Michal Davídek - Programming blog</h1>
            <h3 id="profile-resume"></h3>
          </a>
    
          <hr class="divider long" />
          <p>Developer community gave me a lot for free. This is my attempt to return at least something to all interested.</p>
          <hr class="divider short" />
          <div class="navigation">
            <div class="profile contact">
              
              <nav class="navigation right">
                <ul class="social expanded">
              
              
                  <!-- Twitter -->
                  <li class="social item hvr-grow-rotate">
                    <a rel="me" href="https://twitter.com/mikealdo007" title="Twitter account">
                      <i class='icon icon-social-twitter'></i>
                      <span class="label">Twitter</span>
                    </a>
                  </li>
              
                  <!-- Google Plus -->
                  <li class="social item hvr-grow-rotate">
                    <a rel="me" href="https://plus.google.com/+MichalDavidekCZ" title="Google+ account">
                      <i class='icon icon-social-google-plus'></i>
                      <span class="label">Google-plus</span>
                    </a>
                  </li>
              
                  <!-- Github -->
                  <li class="social item hvr-grow-rotate">
                    <a rel="me" href="https://github.com/mikealdo" title="Github account">
                      <i class='icon icon-social-github'></i>
                      <span class="label">Github</span>
                    </a>
                  </li>
                  </li>
              
              
              
              
                  <!-- LinkedIn -->
                  <li class="social item hvr-grow-rotate">
                    <a rel="me" href="https://www.linkedin.com/in/davidekmichal" title="LinkedIn account">
                      <i class='icon icon-social-linkedin'></i>
                      <span class="label">LinkedIn</span>
                    </a>
                  </li>
              
                  <!-- Email -->
                  <li class="social item hvr-grow-rotate">
                    <a rel="me" href="mailto:mdavidek1@gmail.com" title="Email mdavidek1@gmail.com">
                      <i class='icon icon-mail'></i>
                      <span class="label">Email</span>
                    </a>
                  </li>
              
                </ul>
              </nav>
              <!-- <section class="icon icon-search" id="search-container">
      <hr class="divider short" />
      <form id="search-form">
        <input type="text", name="search", placeholder="git, css, javascript,..." id="search-field" />
      </form>
    </section>
     -->
            </div>
          </div>
        </div>
      </div>
    </aside>
    <main>
      <section id="search-results"></section>
      <section class="content">
        

  <article class="post tag-continuous-delivery tag-git tag-jenkins tag-stash">
    <header>
      <div class="post meta">
        <time datetime="02 Nov 2015">02 Nov 2015</time>
        <span class="post tags">in <a href="https://mikealdo.github.io/tag/continuous-delivery">continuous delivery</a> <a href="https://mikealdo.github.io/tag/git"> git</a> <a href="https://mikealdo.github.io/tag/jenkins"> jenkins</a> <a href="https://mikealdo.github.io/tag/stash"> stash</a></span>


        <span class="post reading-time"> ~ <span></span> read.</span>
      </div>
      <a alt="Tweet 'Read only master branch'" href="https://twitter.com/intent/tweet?text=Read%20only%20master%20branch%20%C2%BB&amp;hashtags=continuous delivery, git, jenkins, stash&amp;url=https://mikealdo.github.io/2015/11/02/Read-only-master-branch.html">
        <img id="post-image" src=https://mikealdo.github.io/images//covers/read-only-master-branch.png alt="Read only master branch">
        <h1 class="icon-reverse icon-social-twitter-post" id="post-title">Read only master branch</h1>
      </a>
    </header>

    <div id="post-content" class="post tag-continuous-delivery tag-git tag-jenkins tag-stash">
      <div class="sect1">
<h2 id="_continuous_delivery">Continuous delivery</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Continuous_delivery">Continuous delivery</a> is about delivering high quality software to customer immediately after next feature is added to the codebase. This adding is based on version control system and now I would like to discuss one step in this process which is almost required to have always shippable product. It&#8217;s called read-only master branch.</p>
</div>
<div class="paragraph">
<p>In my last project we have disovered that combo "pull requests + code review" is not enough to have always green automatic build for master branch. We were using it for some time successfuly but at one point more developers was on the project and codebase (+build time) grew up. And our continous integration server was far away from blue and shinny. We realized that we missed two important things before merging our feature to master branch and proceeding build on master branch. First of all build with unit and integration tests before merge and after that avoiding direct merges to master.</p>
</div>
<div class="paragraph">
<p>Without needs to have pull request there were always some inconsistent commits which should fix something quickly but with increased build time of all needed things (~ 15 min) and failures. It was very unpleasant to work with such master branch. You should be carefull in creating feature branch and check healthy of build of master before it. With increasing number of commits (~ 100 daily) was very hard (aka impossible) to find out which change caused failure. And it was impossible to do continous delivery because at the end we weren&#8217;t able to build anything for whole day.</p>
</div>
<div class="paragraph">
<p>So firstly we implemented <em>"pull request build"</em> to run whole build from your feature branch separately to verify that your changes doesn&#8217;t break anything. But it was not enough because it was not preventing our architects, gurus, senior developers to commit "well intended" changes directly to master. Enforcing rule that each developer should use feature branches, pull requests, code review and pull request builds only by word simply didn&#8217;t worked. Also rebasing feature branches with current master wasn&#8217;t performed before pull request build in all times which caused similar types of problems.</p>
</div>
<div class="paragraph">
<p>Avoiding direct merges to master (read-only master branch for everybody except automatic process) and allowing it only through UI (stash in our case) changed healthy of our builds dramatically. This button at the end was doing automatic rebase from master and build. If it was succesfull there were another allowed button to merge to master. If not, developer was enforced to resolve problem because without that he wasn&#8217;t able to have his feature in master. We realized that this second "merge" button is better than automatic merge because we were using several repositories and merges to them needed to by synchronized. But for one repository it can be in one step of course.</p>
</div>
<div class="paragraph">
<p><strong>Technologically</strong>, we were using git and as a remote repository <a href="https://www.atlassian.com/software/bitbucket/server">stash</a>. Build server <a href="https://jenkins-ci.org">jenkins</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_in_conclusion">In conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you have only possibility to merge to master by using feature branch, pull request and button in remote VCS repository it&#8217;s impossible to add to master incompatible changes which will break builds. And read-only master branch is one step further to implement continuous delivery to your project.</p>
</div>
<div class="paragraph">
<p><strong>P.S.</strong> If you enjoyed reading this blog post, could you do me favor and tweet it? Thanks!</p>
</div>
</div>
</div>
    </div>

    <div class="post related">

    </div>

    <footer class="post comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname = 'mikealdo'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </footer>

  </article>


        <footer>
          <span class="copyright">
            &copy; 2016. All rights reserved. Built with <a href="https://github.com/Kikobeats/uno-zen" target="_blank">Uno Zen</a> under <a href="http://hubpress.io/" target="_blank">HubPress</a>.
          </span>
        </footer>
      </section>
    </main>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>
    <script src="//mikealdo.github.io/themes/uno-zen/assets/js/uno-zen.js?v=1.0.0" type="text/javascript" charset="utf-8"></script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-72815761-1', 'auto');
    ga('send', 'pageview');

    </script>
  </body>
</html>
